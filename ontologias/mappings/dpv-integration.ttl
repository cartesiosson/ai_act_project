@prefix ai: <http://ai-act.eu/ai#> .
@prefix dpv: <https://w3id.org/dpv#> .
@prefix dpv-ai: <https://w3id.org/dpv/ai#> .
@prefix dpv-risk: <https://w3id.org/dpv/risk#> .
@prefix dpv-tech: <https://w3id.org/dpv/tech#> .
@prefix dpv-legal-eu-aiact: <https://w3id.org/dpv/legal/eu/aiact#> .
@prefix dpv-legal-eu-gdpr: <https://w3id.org/dpv/legal/eu/gdpr#> .
@prefix eli: <http://data.europa.eu/eli/ontology#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .

# ===== DPV INTEGRATION MODULE =====
# Version: 0.2.0
# Date: 2025-12-23
# Purpose: Integrate W3C Data Privacy Vocabulary (DPV) 2.2 with SERAMIS AI Act Ontology
#
# This module provides:
# 1. Namespace declarations for DPV extensions
# 2. Mappings between AI Act requirements and DPV Technical/Organizational Measures
# 3. Evidence types for compliance documentation
# 4. Risk-to-measure mappings for Evidence Planner Agent
# 5. ELI (European Legislation Identifier) URIs for EUR-Lex interoperability
# =====

<http://ai-act.eu/ai-act/dpv-integration> a owl:Ontology ;
    owl:imports <http://ai-act.eu/ai-act> ;
    dct:created "2025-12-14"^^xsd:date ;
    dct:modified "2025-12-23"^^xsd:date ;
    dct:title "DPV Integration Module for SERAMIS"@en,
        "Modulo de Integracion DPV para SERAMIS"@es ;
    dct:description "Maps EU AI Act requirements to W3C Data Privacy Vocabulary (DPV) 2.2 concepts for evidence planning and compliance documentation. Includes ELI URIs for EUR-Lex interoperability."@en,
        "Mapea requisitos del EU AI Act a conceptos del W3C Data Privacy Vocabulary (DPV) 2.2 para planificacion de evidencias y documentacion de cumplimiento. Incluye URIs ELI para interoperabilidad con EUR-Lex."@es ;
    owl:versionInfo "0.2.0" ;
    rdfs:seeAlso <https://w3c.github.io/dpv/>,
        <http://data.europa.eu/eli/reg/2024/1689/oj> .


# ===== EVIDENCE TYPES =====
# Types of evidence that can be generated/collected for compliance

ai:Evidence a owl:Class ;
    rdfs:label "Evidence"@en, "Evidencia"@es ;
    rdfs:comment "Documentary or technical evidence demonstrating compliance with a requirement"@en,
        "Evidencia documental o tecnica que demuestra cumplimiento con un requisito"@es .

ai:PolicyEvidence a owl:Class ;
    rdfs:subClassOf ai:Evidence ;
    rdfs:label "Policy Evidence"@en, "Evidencia de Politica"@es ;
    rdfs:comment "Organizational policies, procedures, and guidelines"@en ;
    skos:example "Human oversight policy", "Data governance policy", "AI ethics policy" .

ai:TechnicalEvidence a owl:Class ;
    rdfs:subClassOf ai:Evidence ;
    rdfs:label "Technical Evidence"@en, "Evidencia Tecnica"@es ;
    rdfs:comment "Technical documentation, configurations, and system outputs"@en ;
    skos:example "System architecture diagrams", "API documentation", "Model cards" .

ai:AuditEvidence a owl:Class ;
    rdfs:subClassOf ai:Evidence ;
    rdfs:label "Audit Evidence"@en, "Evidencia de Auditoria"@es ;
    rdfs:comment "Audit logs, test results, and verification records"@en ;
    skos:example "Bias audit reports", "Penetration test results", "Accuracy metrics" .

ai:TrainingEvidence a owl:Class ;
    rdfs:subClassOf ai:Evidence ;
    rdfs:label "Training Evidence"@en, "Evidencia de Formacion"@es ;
    rdfs:comment "Training records, certifications, and competency assessments"@en ;
    skos:example "Operator training certificates", "Awareness training records" .

ai:AssessmentEvidence a owl:Class ;
    rdfs:subClassOf ai:Evidence ;
    rdfs:label "Assessment Evidence"@en, "Evidencia de Evaluacion"@es ;
    rdfs:comment "Impact assessments, risk assessments, and conformity assessments"@en ;
    skos:example "FRIA report", "DPIA report", "Conformity assessment certificate" .

ai:ContractualEvidence a owl:Class ;
    rdfs:subClassOf ai:Evidence ;
    rdfs:label "Contractual Evidence"@en, "Evidencia Contractual"@es ;
    rdfs:comment "Contracts, agreements, and legal documents"@en ;
    skos:example "Data processing agreements", "Provider contracts", "SLAs" .


# ===== EVIDENCE PROPERTIES =====

ai:requiresEvidence a owl:ObjectProperty ;
    rdfs:label "requires evidence"@en, "requiere evidencia"@es ;
    rdfs:domain ai:ComplianceRequirement ;
    rdfs:range ai:Evidence ;
    rdfs:comment "Links a requirement to the type of evidence needed to demonstrate compliance"@en .

ai:evidenceDescription a owl:DatatypeProperty ;
    rdfs:label "evidence description"@en, "descripcion de evidencia"@es ;
    rdfs:domain ai:Evidence ;
    rdfs:range xsd:string ;
    rdfs:comment "Detailed description of what the evidence should contain"@en .

ai:evidencePriority a owl:DatatypeProperty ;
    rdfs:label "evidence priority"@en, "prioridad de evidencia"@es ;
    rdfs:domain ai:Evidence ;
    rdfs:range xsd:string ;
    rdfs:comment "Priority level: CRITICAL, HIGH, MEDIUM, LOW"@en .

ai:evidenceFrequency a owl:DatatypeProperty ;
    rdfs:label "evidence frequency"@en, "frecuencia de evidencia"@es ;
    rdfs:domain ai:Evidence ;
    rdfs:range xsd:string ;
    rdfs:comment "How often evidence should be updated: ONCE, ANNUALLY, QUARTERLY, CONTINUOUS"@en .


# ===== DPV MEASURE MAPPINGS =====
# Maps AI Act requirements to DPV Technical/Organizational Measures

ai:mapsToDPVMeasure a owl:ObjectProperty ;
    rdfs:label "maps to DPV measure"@en, "mapea a medida DPV"@es ;
    rdfs:domain ai:ComplianceRequirement ;
    rdfs:comment "Links an AI Act requirement to corresponding DPV technical/organizational measures"@en .


# ===== REQUIREMENT TO MEASURE MAPPINGS =====

# --- Human Oversight Requirement (Art. 14) ---
ai:HumanOversightRequirement
    ai:mapsToDPVMeasure dpv:HumanInvolvement ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_14/oj> ;
    ai:requiresEvidence ai:HumanOversightPolicyEvidence,
        ai:OverrideDecisionLogEvidence,
        ai:OperatorTrainingEvidence .

ai:HumanOversightPolicyEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Documented policy defining human oversight mechanisms, escalation procedures, and operator responsibilities"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:OverrideDecisionLogEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Logs of human override decisions, including timestamps, operator ID, and justification"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "CONTINUOUS" .

ai:OperatorTrainingEvidence a ai:TrainingEvidence ;
    ai:evidenceDescription "Training records for AI system operators including competency assessments"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- Transparency Requirement (Art. 13) ---
ai:TransparencyRequirement
    ai:mapsToDPVMeasure dpv:Transparency ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_13/oj> ;
    ai:requiresEvidence ai:UserNotificationEvidence,
        ai:SystemDescriptionEvidence,
        ai:AIDisclosureEvidence .

ai:UserNotificationEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Evidence that users are informed they are interacting with an AI system"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ONCE" .

ai:SystemDescriptionEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Plain-language description of system capabilities, limitations, and intended use"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:AIDisclosureEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Policy and implementation of AI system disclosure to affected persons"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ONCE" .


# --- Fundamental Rights Assessment (Art. 27) ---
ai:FundamentalRightsAssessmentRequirement
    ai:mapsToDPVMeasure dpv:ImpactAssessment ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_27/oj> ;
    ai:requiresEvidence ai:FRIAReportEvidence,
        ai:AffectedPersonsAnalysisEvidence,
        ai:MitigationPlanEvidence .

ai:FRIAReportEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Fundamental Rights Impact Assessment (FRIA) report per Art. 27, documenting risks to fundamental rights"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:AffectedPersonsAnalysisEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Analysis of categories of persons affected by the AI system and specific risks to each"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:MitigationPlanEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Documented mitigation measures for identified fundamental rights risks"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- Data Governance Requirement (Art. 10) ---
ai:DataGovernanceRequirement
    ai:mapsToDPVMeasure dpv:DataGovernancePolicies ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_10/oj> ;
    ai:requiresEvidence ai:DataQualityPolicyEvidence,
        ai:TrainingDataDocumentationEvidence,
        ai:DataProvenanceEvidence .

ai:DataQualityPolicyEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Policy defining data quality standards, validation procedures, and bias monitoring"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:TrainingDataDocumentationEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Documentation of training data sources, characteristics, and preprocessing steps"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ONCE" .

ai:DataProvenanceEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Records of data origin, transformations, and chain of custody"@en ;
    ai:evidencePriority "MEDIUM" ;
    ai:evidenceFrequency "CONTINUOUS" .


# --- Documentation Requirement (Art. 11) ---
ai:DocumentationRequirement
    ai:mapsToDPVMeasure dpv:RecordsOfActivities ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_11/oj> ;
    ai:requiresEvidence ai:TechnicalDocumentationEvidence,
        ai:ModelCardEvidence,
        ai:VersionControlEvidence .

ai:TechnicalDocumentationEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Complete technical documentation per Annex IV including system design, algorithms, and validation"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:ModelCardEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Model card documenting model capabilities, limitations, intended use, and performance metrics"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:VersionControlEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Version control records showing changes to AI system over time"@en ;
    ai:evidencePriority "MEDIUM" ;
    ai:evidenceFrequency "CONTINUOUS" .


# --- Risk Management Requirement (Art. 9) ---
ai:RiskManagementRequirement
    ai:mapsToDPVMeasure dpv:RiskManagementPlan ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_9/oj> ;
    ai:requiresEvidence ai:RiskManagementSystemEvidence,
        ai:RiskRegisterEvidence,
        ai:RiskMonitoringEvidence .

ai:RiskManagementSystemEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Documented risk management system established per Art. 9, including methodology and governance"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:RiskRegisterEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Register of identified risks, their assessment, and treatment decisions"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "QUARTERLY" .

ai:RiskMonitoringEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Records of ongoing risk monitoring and periodic risk reassessments"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "CONTINUOUS" .


# --- Non-Discrimination Requirement (Art. 10) ---
ai:NonDiscriminationRequirement
    ai:mapsToDPVMeasure dpv:BiasAssessment ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_10/oj> ;
    ai:requiresEvidence ai:BiasAuditReportEvidence,
        ai:FairnessMetricsEvidence,
        ai:ProtectedGroupAnalysisEvidence .

ai:BiasAuditReportEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Independent bias audit report analyzing system outputs across protected characteristics"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:FairnessMetricsEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Quantitative fairness metrics (demographic parity, equalized odds, etc.) with thresholds"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "QUARTERLY" .

ai:ProtectedGroupAnalysisEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Analysis of system performance across protected groups (gender, ethnicity, age, disability)"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- Accuracy Requirement (Art. 15) ---
ai:AccuracyEvaluationRequirement
    ai:mapsToDPVMeasure dpv:ReviewProcedure ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_15/oj> ;
    ai:requiresEvidence ai:AccuracyTestReportEvidence,
        ai:ValidationDatasetEvidence,
        ai:PerformanceBaselineEvidence .

ai:AccuracyTestReportEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Test reports showing accuracy metrics on representative datasets"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "QUARTERLY" .

ai:ValidationDatasetEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Documentation of validation datasets used for accuracy testing"@en ;
    ai:evidencePriority "MEDIUM" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:PerformanceBaselineEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Established performance baseline and acceptable deviation thresholds"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- Robustness Requirement (Art. 15) ---
ai:RobustnessRequirement
    ai:mapsToDPVMeasure dpv:SecurityAssessment ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_15/oj> ;
    ai:requiresEvidence ai:RobustnessTestReportEvidence,
        ai:AdversarialTestingEvidence,
        ai:FailsafeMechanismEvidence .

ai:RobustnessTestReportEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Test reports demonstrating system robustness under various conditions"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:AdversarialTestingEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Results of adversarial testing and red-team exercises"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:FailsafeMechanismEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Documentation of failsafe mechanisms and graceful degradation capabilities"@en ;
    ai:evidencePriority "MEDIUM" ;
    ai:evidenceFrequency "ONCE" .


# --- Traceability Requirement (Art. 12) ---
ai:TraceabilityRequirement
    ai:mapsToDPVMeasure dpv:RecordsOfActivities ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_12/oj> ;
    ai:requiresEvidence ai:AuditLogEvidence,
        ai:DecisionTraceEvidence,
        ai:LogRetentionPolicyEvidence .

ai:AuditLogEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Automatic logging of system events, inputs, outputs, and decisions"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "CONTINUOUS" .

ai:DecisionTraceEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Capability to trace individual decisions back to inputs and model state"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "CONTINUOUS" .

ai:LogRetentionPolicyEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Policy defining log retention periods and secure storage requirements"@en ;
    ai:evidencePriority "MEDIUM" ;
    ai:evidenceFrequency "ONCE" .


# --- Security Requirement (Art. 15) ---
ai:SecurityRequirement
    ai:mapsToDPVMeasure dpv:TechnicalSecurityMeasure ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_15/oj> ;
    ai:requiresEvidence ai:SecurityAuditReportEvidence,
        ai:PenetrationTestEvidence,
        ai:SecurityPolicyEvidence .

ai:SecurityAuditReportEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Security audit report covering system infrastructure, APIs, and data protection"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:PenetrationTestEvidence a ai:AuditEvidence ;
    ai:evidenceDescription "Penetration testing results for AI system and supporting infrastructure"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:SecurityPolicyEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Security policy covering access control, encryption, and incident response"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- GPAI Transparency (Art. 53) ---
ai:GPAITransparencyRequirement
    ai:mapsToDPVMeasure dpv:Transparency ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_53/oj> ;
    ai:requiresEvidence ai:GPAIModelCardEvidence,
        ai:TrainingDataSummaryEvidence,
        ai:CopyrightComplianceEvidence .

ai:GPAIModelCardEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Model card for GPAI system per Art. 52, including capabilities and limitations"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:TrainingDataSummaryEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Summary of training data sources and content types used"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ONCE" .

ai:CopyrightComplianceEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Documentation of copyright compliance policy for training data"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- Protection of Minors (linked to Art. 5.1.b and Annex III) ---
ai:ProtectionOfMinorsRequirement
    ai:mapsToDPVMeasure dpv:ChildrenDataProtection ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_5/par_1/pnt_b/oj>,
        <http://data.europa.eu/eli/reg/2024/1689/anx_III/oj> ;
    ai:requiresEvidence ai:AgeVerificationEvidence,
        ai:MinorsImpactAssessmentEvidence,
        ai:ParentalConsentEvidence .

ai:AgeVerificationEvidence a ai:TechnicalEvidence ;
    ai:evidenceDescription "Implementation of age verification mechanisms where applicable"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ONCE" .

ai:MinorsImpactAssessmentEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Specific assessment of impacts on children and minors"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:ParentalConsentEvidence a ai:ContractualEvidence ;
    ai:evidenceDescription "Parental consent mechanisms and records where applicable"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "CONTINUOUS" .


# ===== DPV-LEGAL EU AI ACT ALIGNMENTS =====
# Align our concepts with dpv-legal-eu-aiact where applicable

ai:ComplianceRequirement owl:equivalentClass dpv-legal-eu-aiact:AIActRequirement .
ai:HighRisk owl:equivalentClass dpv-legal-eu-aiact:RiskLevelHigh .
ai:MinimalRisk owl:equivalentClass dpv-legal-eu-aiact:RiskLevelMinimal .
ai:Unacceptable owl:equivalentClass dpv-legal-eu-aiact:RiskLevelProhibited .

ai:AIDeployer owl:equivalentClass dpv-legal-eu-aiact:AIDeployer .
ai:AIDeveloper owl:equivalentClass dpv-legal-eu-aiact:AIProvider .

ai:FundamentalRightsAssessmentRequirement rdfs:seeAlso dpv-legal-eu-aiact:FRIA .
ai:ConformityAssessment rdfs:seeAlso dpv-legal-eu-aiact:ConformityAssessment .


# ===== EVIDENCE PLAN CLASS =====
# For the Evidence Planner Agent

ai:EvidencePlan a owl:Class ;
    rdfs:label "Evidence Plan"@en, "Plan de Evidencias"@es ;
    rdfs:comment "A structured plan for generating compliance evidence based on identified gaps"@en .

ai:hasGap a owl:ObjectProperty ;
    rdfs:label "has gap"@en ;
    rdfs:domain ai:EvidencePlan ;
    rdfs:range ai:ComplianceRequirement ;
    rdfs:comment "Links an evidence plan to the compliance gap it addresses"@en .

ai:hasEvidenceItem a owl:ObjectProperty ;
    rdfs:label "has evidence item"@en ;
    rdfs:domain ai:EvidencePlan ;
    rdfs:range ai:Evidence ;
    rdfs:comment "Links an evidence plan to required evidence items"@en .

ai:planPriority a owl:DatatypeProperty ;
    rdfs:label "plan priority"@en ;
    rdfs:domain ai:EvidencePlan ;
    rdfs:range xsd:string ;
    rdfs:comment "Overall priority of the evidence plan: CRITICAL, HIGH, MEDIUM, LOW"@en .

ai:planDeadline a owl:DatatypeProperty ;
    rdfs:label "plan deadline"@en ;
    rdfs:domain ai:EvidencePlan ;
    rdfs:range xsd:string ;
    rdfs:comment "Recommended deadline for evidence generation"@en .

ai:responsibleRole a owl:DatatypeProperty ;
    rdfs:label "responsible role"@en ;
    rdfs:domain ai:EvidencePlan ;
    rdfs:range xsd:string ;
    rdfs:comment "Role responsible for generating this evidence: DEPLOYER, PROVIDER, DPO, LEGAL, TECHNICAL"@en .


# =============================================================================
# DPV MAPPINGS FOR SCOPE EXCLUSIONS (v0.39.0)
# =============================================================================
# Maps EU AI Act Article 2 scope exclusions to DPV concepts
# These mappings enable semantic interoperability for scope determination

# --- New Properties for Scope Mappings ---

ai:mapsToDPVConcept a owl:ObjectProperty ;
    rdfs:label "maps to DPV concept"@en, "mapea a concepto DPV"@es ;
    rdfs:comment "Maps AI Act concept to equivalent DPV concept"@en .

ai:mapsToDPVPurpose a owl:ObjectProperty ;
    rdfs:label "maps to DPV purpose"@en, "mapea a proposito DPV"@es ;
    rdfs:domain ai:ScopeExclusion ;
    rdfs:comment "Maps scope exclusion to equivalent DPV purpose concept"@en .

ai:mapsToDPVProcessingContext a owl:ObjectProperty ;
    rdfs:label "maps to DPV processing context"@en ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Maps deployment context to DPV processing context"@en .

ai:mapsToDPVRisk a owl:ObjectProperty ;
    rdfs:label "maps to DPV risk"@en, "mapea a riesgo DPV"@es ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Maps context to DPV risk category"@en .

ai:mapsToDPVLegalBasis a owl:ObjectProperty ;
    rdfs:label "maps to DPV legal basis"@en ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Maps context to DPV legal basis"@en .

ai:mapsToDPVDataSubject a owl:ObjectProperty ;
    rdfs:label "maps to DPV data subject"@en ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Maps context to DPV data subject category"@en .

ai:mapsToDPVData a owl:ObjectProperty ;
    rdfs:label "maps to DPV data category"@en ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Maps context to DPV data category"@en .

ai:mapsToDPVProcessing a owl:ObjectProperty ;
    rdfs:label "maps to DPV processing"@en ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Maps context to DPV processing operation"@en .

ai:triggersDPVObligation a owl:ObjectProperty ;
    rdfs:label "triggers DPV obligation"@en, "activa obligacion DPV"@es ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:comment "Context triggers a DPV organizational measure obligation (e.g., DPIA)"@en .


# --- Scope Exclusion Mappings to DPV Purposes ---

ai:PersonalNonProfessionalUse
    ai:mapsToDPVConcept dpv:PersonalUse ;
    ai:mapsToDPVPurpose dpv:PersonalUse ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_2/par_10/oj> ;
    rdfs:comment "Maps to DPV personal use purpose - non-professional activities excluded from AI Act scope"@en .

ai:PureScientificResearch
    ai:mapsToDPVConcept dpv:AcademicResearch ;
    ai:mapsToDPVPurpose dpv:ScientificResearch ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_2/par_6/oj> ;
    rdfs:comment "Maps to DPV academic/scientific research purpose - pure research excluded from AI Act scope"@en .

ai:EntertainmentWithoutRightsImpact
    ai:mapsToDPVConcept dpv:ServiceProvision ;
    ai:mapsToDPVPurpose dpv:ProvideEntertainment ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/rec_12/oj> ;
    rdfs:comment "Maps to DPV entertainment service provision - entertainment without rights impact excluded per Recital 12"@en .

ai:MilitaryDefenseUse
    ai:mapsToDPVConcept dpv:PublicSecurity ;
    ai:mapsToDPVPurpose dpv:NationalSecurity ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_2/par_3/oj> ;
    rdfs:comment "Maps to DPV national security purpose - military/defense use excluded with exceptions"@en .


# --- Override Context Mappings to DPV Risks and Contexts ---

ai:LegalConsequencesContext
    ai:mapsToDPVProcessingContext dpv:LegalProceeding ;
    ai:mapsToDPVLegalBasis dpv:LegalObligation ;
    ai:mapsToDPVRisk dpv-risk:LegalRisk ;
    rdfs:comment "Context where legal proceedings result from AI actions - overrides exclusions"@en .

ai:VictimImpactContext
    ai:mapsToDPVRisk dpv-risk:HarmToIndividuals ;
    ai:mapsToDPVDataSubject dpv:VulnerableDataSubject ;
    ai:triggersDPVObligation dpv:ImpactAssessment ;
    rdfs:comment "Context where identifiable victims are affected - overrides exclusions and triggers DPIA"@en .

ai:CausesRealWorldHarmContext
    ai:mapsToDPVRisk dpv-risk:PhysicalHarm ;
    ai:mapsToDPVRisk dpv-risk:MaterialDamage ;
    ai:triggersDPVObligation dpv:ImpactAssessment ;
    rdfs:comment "Context where real-world physical or material harm occurs - overrides exclusions"@en .

ai:AffectsFundamentalRightsContext
    ai:mapsToDPVRisk dpv-risk:RightsImpact ;
    ai:triggersDPVObligation dpv:DPIA ;
    ai:triggersDPVObligation dpv:ImpactAssessment ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_27/oj> ;
    rdfs:comment "Context affecting fundamental rights - overrides ALL exclusions and triggers FRIA per Art. 27"@en .

ai:BiometricProcessingContext
    ai:mapsToDPVData dpv:BiometricData ;
    ai:mapsToDPVProcessing dpv:Collect ;
    ai:mapsToDPVProcessing dpv:Use ;
    ai:triggersDPVObligation dpv:DPIA ;
    eli:cites <http://data.europa.eu/eli/reg/2016/679/art_9/oj> ;
    rdfs:comment "Context involving biometric data processing - overrides exclusions and triggers GDPR Art. 9 obligations"@en .


# =============================================================================
# FRIA TRIGGERS FROM OVERRIDE CONTEXTS (v0.39.0)
# =============================================================================
# Fundamental Rights Impact Assessment (FRIA) requirements per Article 27
# Override contexts that bring systems back into scope may require FRIA

# --- New Properties for FRIA ---

ai:requiresFRIA a owl:DatatypeProperty ;
    rdfs:label "requires FRIA"@en, "requiere EIFF"@es ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:range xsd:boolean ;
    rdfs:comment "Indicates whether this context requires a Fundamental Rights Impact Assessment per Art. 27"@en .

ai:friaCategory a owl:DatatypeProperty ;
    rdfs:label "FRIA category"@en, "categoria EIFF"@es ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:range xsd:string ;
    rdfs:comment "Category of FRIA assessment required based on impact type"@en .

ai:friaUrgency a owl:DatatypeProperty ;
    rdfs:label "FRIA urgency"@en, "urgencia EIFF"@es ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:range xsd:string ;
    rdfs:comment "Urgency level for FRIA completion: Low, Medium, High, Critical"@en .

ai:friaArticle a owl:DatatypeProperty ;
    rdfs:label "FRIA article reference"@en ;
    rdfs:domain ai:DeploymentContext ;
    rdfs:range xsd:string ;
    rdfs:comment "EU AI Act article reference mandating FRIA for this context"@en .


# --- Override Contexts with FRIA Requirements ---

ai:VictimImpactContext
    ai:requiresFRIA "true"^^xsd:boolean ;
    ai:friaCategory "Direct harm to individuals" ;
    ai:friaUrgency "High" ;
    ai:friaArticle "Article 27 - FRIA for deployers affecting natural persons" .

ai:AffectsFundamentalRightsContext
    ai:requiresFRIA "true"^^xsd:boolean ;
    ai:friaCategory "Fundamental rights impact" ;
    ai:friaUrgency "Critical" ;
    ai:friaArticle "Article 27.1 - Mandatory FRIA for high-risk AI affecting fundamental rights" .

ai:LegalConsequencesContext
    ai:requiresFRIA "true"^^xsd:boolean ;
    ai:friaCategory "Legal proceedings impact" ;
    ai:friaUrgency "High" ;
    ai:friaArticle "Article 27 - FRIA for systems with legal effects on natural persons" .

ai:CausesRealWorldHarmContext
    ai:requiresFRIA "true"^^xsd:boolean ;
    ai:friaCategory "Physical or material harm" ;
    ai:friaUrgency "Critical" ;
    ai:friaArticle "Article 27 + Article 73 - FRIA and mandatory incident reporting" .

ai:BiometricProcessingContext
    ai:requiresFRIA "true"^^xsd:boolean ;
    ai:friaCategory "Biometric data processing" ;
    ai:friaUrgency "High" ;
    ai:friaArticle "Article 27.1 - FRIA for biometric identification by deployers" .


# --- Scope Override Assessment Evidence ---

ai:ScopeOverrideAssessmentRequirement a ai:ComplianceRequirement ;
    rdfs:label "Scope Override Assessment Requirement"@en ;
    ai:mapsToDPVMeasure dpv:LegalBasis ;
    ai:mapsToDPVMeasure dpv:ImpactAssessment ;
    eli:cites <http://data.europa.eu/eli/reg/2024/1689/art_2/oj> ;
    ai:requiresEvidence ai:ScopeJustificationEvidence,
        ai:ContextOverrideAnalysisEvidence .

ai:ScopeJustificationEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Document justifying why system is in/out of EU AI Act scope based on Article 2 exclusions"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ONCE" .

ai:ContextOverrideAnalysisEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Analysis of deployment contexts that bring excluded purposes back into EU AI Act scope"@en ;
    ai:evidencePriority "CRITICAL" ;
    ai:evidenceFrequency "ANNUALLY" .


# --- FRIA Specific Evidence ---

ai:FRIAConsultationEvidence a ai:AssessmentEvidence ;
    ai:evidenceDescription "Records of stakeholder consultation during FRIA process including affected persons representatives"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:FRIARemediationPlanEvidence a ai:PolicyEvidence ;
    ai:evidenceDescription "Plan for remediating identified fundamental rights risks with timelines and responsible parties"@en ;
    ai:evidencePriority "HIGH" ;
    ai:evidenceFrequency "ANNUALLY" .

ai:FundamentalRightsAssessmentRequirement
    ai:requiresEvidence ai:FRIAConsultationEvidence,
        ai:FRIARemediationPlanEvidence .
